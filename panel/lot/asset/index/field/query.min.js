!function(){"use strict";var t=function(t,n){return-1!==n.indexOf(t)},n=function(t){return Array.isArray(t)},e=function(t,n){return t&&i(n)&&t instanceof n},r=function(t){return"number"==typeof t},u=function(t,n){return void 0===n&&(n=!0),"object"==typeof t&&(!n||e(t,Object))},i=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},o=function(t){return"string"==typeof t},c=function(t,n){var e=n.indexOf(t);return-1!==e?e:null},f=function(t){return t.toLowerCase()},a=function(t){return t.length},s=function(t){return Object.keys(t)},l=function t(e){if(n(e))return e.map((function(n){return t(n)}));if(function(t){return/^-?(?:\d*.)?\d+$/.test(t+"")}(e))return function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(e);if(u(e)){for(var r in e)e[r]=t(e[r]);return e}return"false"!==e&&("null"===e?null:"true"===e||e)},v=function e(){for(var r=arguments.length,o=Array(r),c=0;c<r;c++)o[c]=arguments[c];for(var f=o.shift(),s=0,l=a(o);s<l;++s)for(var v in o[s])if(i(f[v]))if(n(f[v])&&n(o[s][v])){f[v]=[].concat(f[v]);for(var g=0,d=a(o[s][v]);g<d;++g)t(o[s][v][g],f[v])||f[v].push(o[s][v][g])}else u(f[v])&&u(o[s][v])?f[v]=e({},f[v],o[s][v]):f[v]=o[s][v];else f[v]=o[s][v];return f},g=function t(e){if(n(e))return e.map((function(n){return t(e)}));if(u(e)){for(var r in e)e[r]=t(e[r]);return e}return!1===e?"false":null===e?"null":!0===e?"true":""+e},d=document,p=window,m=function(t,n,e){if(void 0===e&&(e=!0),!L(t,n))return null;var r=t.getAttribute(n);return e?l(r):r},h=function(t,n){var e=t.children;return r(n)?e[n]||null:e||[]},b=function(t,n,e){void 0===e&&(e=!0);var r=m(t,"data-"+n,e),u=(r+"").trim();return e&&u&&("["===u[0]&&"]"===u.slice(-1)||"{"===u[0]&&"}"===u.slice(-1))&&null!==(u=function(t){var n=null;try{n=JSON.parse(t)}catch(t){}return n}(r))?u:r},y=function(t,n){return n?t.closest(n)||null:t.parentNode||null},k=function(t){var n="form";return R(t,n)&&n===function(t){return f(t&&t.nodeName||"")||null}(t.form)?t.form:y(t,n)},x=function(t){return t.previousElementSibling||null},E=function(t,n){return R(t,n)&&t[n]||null},w=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!R(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},L=function(t,n){return t.hasAttribute(n)},A=function(t,n){return t.classList.contains(n)},T=function(t,n){return null!==y(t,n)},R=function(t,n){return n in t},S=function(t,n){return t.removeAttribute(n),t},N=function(t,n){return t.classList.remove(n),t},P=function(t,e){if(n(e))return e.forEach((function(n){return t.classList.remove(n)})),t;if(u(e)){for(var r in e)e[r]&&t.classList.remove(r);return t}return t.className="",t},C=function(t){var n=y(t);return t.remove(),n},O=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,g(e)),t},K=function(t,n){return t.append(n),n},_=function(t,n){return t.classList.add(n),t},B=function(t,e){if(n(e))return e.forEach((function(n){return t.classList.add(n)})),t;if(u(e))for(var r in e)e[r]?t.classList.add(r):t.classList.remove(r);return t.className=e,t},q=function(t,n,e){return t=o(t)?d.createElement(t):t,u(n)&&(e=n,n=!1),o(n)&&D(t,n),u(e)&&function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?O(t,r,e):S(t,r)}(t,e),t},D=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return R(t,r)&&(t[r]=e?n.trim():n),t},H=function(t,n){return y(t).insertBefore(n,t),n},z=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";return R(t,r)&&(t[r]=e?n.trim():n),t},F=function(t,n){return function(){var e=arguments,r=this;setTimeout((function(){return t.apply(r,e)}),n)}};var I=function(t,n,e){n.removeEventListener(t,e)},J=function(t){return t&&t.preventDefault()},M=function(t,n,e){t.forEach((function(t){return I(t,n,e)}))},$=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},G=function(t,n,e,r){void 0===r&&(r=!1),t.forEach((function(t){return $(t,n,e,r)}))},Q=function(t,n){return function(t){return e(t,RegExp)}(t)?t:(t=t.replace(/\//g,"\\/"),RegExp(t,i(n)?n:"g"))},U="ArrowLeft",V="Home",W="Backspace",X="Tab";function Y(u,l){void 0===l&&(l={});var g=this;if(!u)return g;if(u.TP)return u.TP;if(!e(g,Y))return new Y(u,l);var b=function(){return u.disabled},E=function(){return u.readOnly},L=m(u,"placeholder"),R=m(u,"tabindex"),S=function(t){var n={};return t.hooks=n,t.fire=function(e,r){return i(n[e])?(n[e].forEach((function(n){return n.apply(t,r)})),t):t},t.off=function(e,r){if(!i(e))return n={},t;if(i(n[e]))if(i(r)){for(var u=0,o=n[e].length;u<o;++u)if(r===n[e][u]){n[e].splice(u,1);break}0===j&&delete n[e]}else delete n[e];return t},t.on=function(e,r){return i(n[e])||(n[e]=[]),i(r)&&n[e].push(r),t},t}(g);S.hooks;var O,D=S.fire;g.state=l=v({},Y.state,o(l)?{join:l}:l||{}),g.source=u,Y.instances[u.id||u.name||(O=Y.instances,a(s(O)))]=g,u.TP=g;var Z,tt,nt,et=l.class,rt=et+"__",ut=et+"--",it=k(u),ot=q("div",{class:et,tabindex:!b()&&-1}),ct=q("span",{class:rt+"tag "+rt+"input"}),ft=q("input",{class:rt+"copy",tabindex:-1,type:"text"}),at=q("span",{contenteditable:!b()&&"true",spellcheck:"false",style:"white-space:pre;"}),st=q("span"),lt=q("span",{class:rt+"tags"}),vt=0,gt={};function dt(t,n){var e=c(t,g.tags);return n&&D("get.tag",[t,e]),r(e)?t:null}function pt(){gt={};var t,n=h(lt),e=a(n)-1;for(t=0;t<e;++t)A(n[t],rt+"tag--selected")&&(gt[t]=n[t])}function mt(t,n){r(n)?(n=n<0?0:n,g.tags.splice(n,0,t)):g.tags.push(t),u.value=g.tags.join(l.join)}function ht(t,n){var e=q("span",{class:rt+"tag",tabindex:!b()&&!E()&&0,title:t}),u=q("a",{class:rt+"tag-x",href:"",tabindex:-1,target:"_top"});$("click",u,Bt),K(e,u),$("click",e,_t),G(["blur","focus"],e,Pt),T(lt)&&(r(n)&&g.tags[n]?H(h(lt,n),e):H(ct,e))}function bt(n){if(n=n?n.split(l.join):[],T(ot))for(var e,r,i;e=x(ct);)kt(i=e.title),t(i,n)||(r=c(i,g.tags),D("change",[i,r]),D("let.tag",[i,r]));g.tags=[],u.value="";for(var o,f=0,a=l.max;f<a&&n[f];++f)""!==(o=Rt(n[f]))&&(ht(o),mt(o),D("change",[o,f]),D("set.tag",[o,f]))}function yt(t){var n=c(t,g.tags);r(n)&&n>=0&&(g.tags.splice(n,1),u.value=g.tags.join(l.join))}function kt(t){var n,e=c(t,g.tags);if(r(e)&&e>=0&&(n=h(lt,e))){I("click",n,_t),M(["blur","focus"],n,Pt);var u=n.firstElementChild||null;u&&(I("click",u,Bt),C(u)),C(n)}}function xt(t){C(ft),t&&jt("",1)}function Et(t){K(ot,ft),ft.value=g.tags.join(l.join),t&&(ft.focus(),ft.select())}function jt(t,n){if(z(at,t),z(st,t?"":L),n){at.focus();var e=d.createRange(),r=p.getSelection();e.selectNodeContents(at),e.collapse(!1),r.removeAllRanges(),r.addRange(e)}}function wt(t){Tt(t,(function(){N(this,rt+"tag--selected")}))}function Lt(t){Tt(t,(function(){_(this,rt+"tag--selected")}))}function At(){if(!b()&&!E()){var t=St(w(at)).trim(),n=l.pattern;if(n&&t&&!Q(n,"").test(t))return D("not.tag",[t,-1]),void jt(t,1);if(jt(""),t=Rt(t))if(dt(t))D("has.tag",[t,c(t,g.tags)]);else{ht(t),mt(t);var e=a(g.tags);D("change",[t,e]),D("set.tag",[t,e])}}}function Tt(t,n){var e,r=h(lt),u=a(r)-1;for(e=0;e<u;++e)t!==r[e]&&n.call(r[e],e)}function Rt(t){return St(g.f(t)).trim()}function St(t){return t=t||"",l.escape.forEach((function(n){t=t.split(n).join("")})),t}function Nt(t){"blur"===t.type?(wt(),P(ot,[ut+"focus",ut+"focus-self"])):B(ot,[ut+"focus",ut+"focus-self"])}function Pt(t){if(!E()){gt={};var n=this,e=t.type,r=n.title,u=g.tags,i=c(r,u),o=rt+"tag--";"blur"===e?(!Z&&!tt||tt&&nt)&&(wt(n),N(n,o+"selected"),P(ot,[ut+"focus",ut+"focus-tag"])):(_(n,o+"selected"),B(ot,[ut+"focus",ut+"focus-tag"]),vt=i,gt[i]=n),D(e+".tag",[r,i])}}function Ct(t){var n=g.tags,e=t.type,r=rt+"text--";N(ot,ut+"focus-tag"),"blur"===e?(N(ct,r+"focus"),P(ot,[ut+"focus",ut+"focus-input"]),At()):(_(ct,r+"focus"),B(ot,[ut+"focus",ut+"focus-input"]),wt(ct)),D(e,[n,a(n)])}function Ot(t){"blur"===t.type?N(ot,ut+"focus"):_(ot,ut+"focus")}function Kt(t){t&&ot===t.target&&at.focus();var n=g.tags;D("click",[n,a(n)])}function _t(){var t=this.title,n=g.tags;D("click.tag",[t,c(t,n)])}function Bt(t){if(!b()&&!E()){var n=y(this).title,e=c(n,g.tags);kt(n),yt(n),jt("",1),D("change",[n,e]),D("click.tag",[n,e]),D("let.tag",[n,e])}J(t)}function qt(t){var n=t.type;"copy"===n?F((function(){return xt(1)}))():"cut"===n?(!E()&&bt(""),F((function(){return xt(1)}))()):"paste"===n&&F((function(){!E()&&bt(ft.value),xt(1)}))(),F((function(){var t=g.tags;D(n,[t,a(t)])}),1)()}function Dt(){wt(),N(ot,ut+"focus-self")}function Ht(){at.focus()}function zt(t){if(!b()&&!E()){g.tags;var n,e,r,u,i,o,c=t.key,f=Z=t.ctrlKey,l=tt=t.shiftKey,v=rt+"tag--";if(nt=X===c,!f){if(!l&&(W===c||"Delete"===c)){pt(),o=gt;var d=W===c;for(e in o)kt(i=(n=o[e]).title),yt(i);return vt=+(s(o)[0]||0),(n=h(lt,d?vt-1:vt))?ct===n?jt("",1):n.focus():jt("",1),void J(t)}if(V===c)return void((n=h(lt,0))&&(n.focus(),J(t)));if("End"===c&&(n=h(lt,a(g.tags)-1)))return n.focus(),void J(t);if(U===c){if(n=h(lt,vt-1)){var p=A(n,v+"selected");return n.focus(),J(t),l?(r=n.nextElementSibling||null,void(p&&N(r,v+"selected"))):void wt(n)}if(!l)return void wt(h(lt,0))}if("ArrowRight"===c&&(n=h(lt,vt+1))){var m=A(n,v+"selected");return ct!==n||l?n.focus():jt("",1),J(t),l?(u=x(n),void(m&&N(u,v+"selected"))):void wt(n)}}"a"===c&&(Et(1),Lt(),pt(),J(t))}}function Ft(n){!function(t){t&&t.stopPropagation()}(n),E()&&X!==n.key&&J(n);var e,r=l.escape,u=x(ct),i=a(g.tags),o=l.max,c=Rt(w(at)),f=n.key,s=Z=n.ctrlKey,v="Enter"===f;tt=n.shiftKey;var d=nt=X===f;if(v&&(f="\n"),d&&(f="\t"),F((function(){var e=Rt(w(at));z(st,e?"":L),t(function(t){var n,e=p.getSelection();if(e.rangeCount>0)return(n=e.getRangeAt(0).cloneRange()).collapse(!0),n.setStart(t,0),(n+"").slice(-1)}(at),r)&&(i<o?At():(jt(""),D("max.tags",[o])),J(n))}))(),""===c&&V===f&&(e=h(lt,0)))return e.focus(),void J(n);if(""===c&&"End"===f&&(e=h(lt,a(g.tags)-1)))return e.focus(),void J(n);if(s&&""===c&&"a"===f)return Et(1),Lt(),pt(),void J(n);if(t(f,r))return i<o?At():(jt(""),D("max.tags",[o])),void J(n);if(!d){if(!s&&v)return Mt()&&it&&it.dispatchEvent(new Event("submit",{cancelable:!0})),void J(n);if(u&&""===c&&!E()){if(W===f)return kt(e=g.tags[i-1]),yt(e),D("change",[e,i-1]),D("let.tag",[e,i-1]),void J(n);if(U===f)return void u.focus()}}}function It(){Z=tt=!1}function Jt(){F((function(){b()||E()||w(at).split(l.join).forEach((function(n){t(n,g.tags)||(ht(n),mt(n))})),jt("")}))()}function Mt(t){if(!b()){var n=l.min;return At(),n>0&&a(g.tags)<n?(jt("",1),D("min.tags",[n]),void J(t)):1}}return jt(""),K(ot,lt),K(ct,at),K(ct,st),K(lt,ct),_(u,rt+"source"),y(u).insertBefore(ot,u.nextSibling),q(u,{tabindex:-1}),$("blur",ot,Dt),$("click",ot,Kt),$("focus",u,Ht),$("keydown",ot,zt),$("keydown",at,Ft),$("keyup",ot,It),$("paste",at,Jt),G(["blur","focus"],ot,Ot),G(["blur","focus"],ft,Nt),G(["blur","focus"],at,Ct),G(["copy","cut","paste"],ft,qt),it&&$("submit",it,Mt),g.blur=function(){return!b()&&at.blur(),g},g.click=function(){return ot.click(),Kt(),g},g.f=function(t){return f(t||"").replace(/[^ a-z\d-]/g,"").trim()},g.focus=function(){return b()||jt(w(at),1),g},g.get=function(t){return b()?null:dt(t,1)},g.input=at,g.let=function(t){if(!b()&&!E()){var e=l.min;if(t)if(n(t))t.forEach((function(t){if(e>0&&a(g.tags)<e)return D("min.tags",[e]),g;kt(t),yt(t)}));else{if(e>0&&a(g.tags)<e)return D("min.tags",[e]),g;kt(t),yt(t)}else bt("")}return g},g.pop=function(){if(!u.TP)return g;delete u.TP;var t=g.tags;return N(u,rt+"source"),I("blur",ot,Dt),I("click",ot,Kt),I("focus",u,Ht),I("keydown",ot,zt),I("keydown",at,Ft),I("keyup",ot,It),I("paste",at,Jt),M(["blur","focus"],ot,Ot),M(["blur","focus"],ft,Nt),M(["blur","focus"],at,Ct),M(["copy","cut","paste"],ft,qt),it&&I("submit",it,Mt),t.forEach(kt),q(u,{tabindex:R}),C(ot),D("pop",[t])},g.self=ot,g.set=function(t,e){if(!t)return g;if(!b()&&!E())if(n(t))bt(t.join(l.join));else{var r=g.tags,u=l.max;dt(t)?D("has.tag",[t,c(t,r)]):a(r)<u?(ht(t,e),mt(t,e)):D("max.tags",[u])}return g},g.source=g.output=u,g.state=l,g.tags=[],bt(u.value),g}function Z(){let t;for(let n in Y.instances)t=Y.instances[n],t.pop(),delete Y.instances[n];let n=(e=".lot\\:field.type\\:query input",(r||d).querySelectorAll(e));var e,r;n&&a(n)&&n.forEach((t=>{let n=function(t,n){void 0===n&&(n=!0);var e=(E(t,"className")||"").trim();return n?e.split(/\s+/):e}(t),e=new Y(t,b(t,"state")??{});B(e.self,n)}))}Y.instances={},Y.state={class:"tag-picker",escape:[","],join:", ",max:9999,min:0,pattern:null},Y.version="3.4.9",Z(),p._.on("change",Z),p.TP=Y}();