!function(){"use strict";var e=function(e,t){return-1!==t.indexOf(e)},t=function(e){return Array.isArray(e)},r=function(e){return"function"==typeof e},n=function(e,t){return e&&i(t)&&e instanceof t},o=function(e,t){return void 0===t&&(t=!0),"object"==typeof e&&(!t||n(e,Object))},i=function(e){return function(e){return void 0!==e}(e)&&!function(e){return null===e}(e)},s=function(e){return"string"==typeof e},c=function(e){return e.length},a=function(e,t){return i(t[0])&&e<t[0]?t[0]:i(t[1])&&e>t[1]?t[1]:e},u=function(e){return Object.keys(e)},l=function e(r){if(t(r))return r.map((function(t){return e(t)}));if(function(e){return/^-?(?:\d*.)?\d+$/.test(e+"")}(r))return function(e,t){return void 0===t&&(t=10),t?parseInt(e,t):parseFloat(e)}(r);if(o(r)){for(var n in r)r[n]=e(r[n]);return r}return"false"!==r&&("null"===r?null:"true"===r||r)},f=function(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")},p=function r(){for(var n=arguments.length,s=Array(n),a=0;a<n;a++)s[a]=arguments[a];for(var u=s.shift(),l=0,f=c(s);l<f;++l)for(var p in s[l])if(i(u[p]))if(t(u[p])&&t(s[l][p])){u[p]=[].concat(u[p]);for(var h=0,v=c(s[l][p]);h<v;++h)e(s[l][p][h],u[p])||u[p].push(s[l][p][h])}else o(u[p])&&o(s[l][p])?u[p]=r({},u[p],s[l][p]):u[p]=s[l][p];else u[p]=s[l][p];return u},h=function e(r){if(t(r))return r.map((function(t){return e(r)}));if(o(r)){for(var n in r)r[n]=e(r[n]);return r}return!1===r?"false":null===r?"null":!0===r?"true":""+r},v=document,d=window,m=v.body,g=v.documentElement,b=function(e,t,r){void 0===r&&(r=!0);var n=function(e,t,r){if(void 0===r&&(r=!0),!y(e,t))return null;var n=e.getAttribute(t);return r?l(n):n}(e,"data-"+t,r),o=(n+"").trim();return r&&o&&("["===o[0]&&"]"===o.slice(-1)||"{"===o[0]&&"}"===o.slice(-1))&&null!==(o=function(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}(n))?o:n},y=function(e,t){return e.hasAttribute(t)},$=d.location,w=function(e,t,r){t.removeEventListener(e,r)},k=function(e){return e&&e.preventDefault()},S=function(e,t,r,n){void 0===n&&(n=!1),t.addEventListener(e,r,n)},x=function(e,t){return void 0===t&&(t=""),e.replace(T("["+t+q.replace(/./g,"\\$&")+"]"),"\\$&")},T=function(e,t){return function(e){return n(e,RegExp)}(e)?e:(e=e.replace(/\//g,"\\/"),RegExp(e,i(t)?t:"g"))},q="!$^*()+=[]{}|:<>,.?/-";function L(e,t){return(e||"")["trim"+(-1===t?"Left":1===t?"Right":"")]()}function _(e,o){void 0===o&&(o={});var a=this;if(!e)return a;if(e.TE)return e.TE;if(!n(a,_))return new _(e,o);a.state=o=p({},_.state,s(o)?{tab:o}:o||{}),a.self=a.source=e,_.instances[e.id||e.name||function(e){return c(u(e))}(_.instances)]=a,e.TE=a;var l=/^([\s\S]*?)$/,f=function(){return e.disabled},h=function(){return e.readOnly},v=function(){return e.value.replace(/\r/g,"")};return a.value=v(),a.get=function(){return!f()&&L(v())||null},a.let=function(){return e.value=a.value,a},a.set=function(t){return f()||h()||(e.value=t),a},a.$=function(){return new _.S(e.selectionStart,e.selectionEnd,v())},a.focus=function(t){var r,n;return-1===t?r=n=0:1===t&&(r=c(v()),n=e.scrollHeight),i(r)&&i(n)&&(e.selectionStart=e.selectionEnd=r,e.scrollTop=n),e.focus(),a},a.blur=function(){return e.blur(),a},a.select=function(){if(f()||h())return e.focus(),a;for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var o,i,s,u,l=c(r),p=a.$(),v=p.start,b=p.end;if(o=d.pageXOffset||g.scrollLeft||m.scrollLeft,i=d.pageYOffset||g.scrollTop||m.scrollTop,s=e.scrollLeft,u=e.scrollTop,0===l)r[0]=v,r[1]=b;else if(1===l){if(!0===r[0])return e.focus(),e.select(),a;r[1]=r[0]}return e.focus(),e.selectionStart=r[0],e.selectionEnd=r[1],e.scrollLeft=s,e.scrollTop=u,d.scroll(o,i),a},a.match=function(e,n){var o=a.$(),i=o.after,s=o.before,c=o.value;if(t(e)){var u=[s.match(e[0]),c.match(e[1]),i.match(e[2])];return r(n)?n.call(a,u[0]||[],u[1]||[],u[2]||[]):[!!u[0],!!u[1],!!u[2]]}var l=c.match(e);return r(n)?n.call(a,l||[]):!!l},a.replace=function(e,t,r){var n=a.$(),o=n.after,i=n.before,s=n.value;return-1===r?i=i.replace(e,t):1===r?o=o.replace(e,t):s=s.replace(e,t),a.set(i+s+o).select(i=c(i),i+c(s))},a.insert=function(e,t,r){var n=l;return r&&a.replace(n,""),-1===t?n=/$/:1===t&&(n=/^/),a.replace(n,e,t)},a.wrap=function(e,t,r){var n=a.$(),o=n.after,i=n.before,s=n.value;return r?a.replace(l,e+"$1"+t):a.set(i+e+s+t+o).select(i=c(i+e),i+c(s))},a.peel=function(e,t,r){var n=a.$(),o=n.after,i=n.before,s=n.value;e=x(e),t=x(t);var u=T(e+"$",""),l=T("^"+t,"");return r?a.replace(T("^"+e+"([\\s\\S]*?)"+t+"$",""),"$1"):u.test(i)&&l.test(o)?(i=i.replace(u,""),o=o.replace(l,""),a.set(i+s+o).select(i=c(i),i+c(s))):a.select()},a.pull=function(e,t){void 0===t&&(t=!0);var r=a.$(),n=r.length,s=r.value;return e=x(i(e)?e:o.tab),n?t?a.replace(T("^"+e,"gm"),""):a.insert(s.split("\n").map((function(t){return T("^("+e+")*$","").test(t)?t:t.replace(T("^"+e,""),"")})).join("\n")):a.replace(T(e+"$",""),"",-1)},a.push=function(e,t){void 0===t&&(t=!1);var r=a.$().length;return e=i(e)?e:o.tab,r?a.replace(T("^"+(t?"":"(?!$)"),"gm"),e):a.insert(e,-1)},a.trim=function(e,t,r,n,o){void 0===o&&(o=!0),null!==e&&!1!==e&&(e=e||""),null!==t&&!1!==t&&(t=t||""),null!==r&&!1!==r&&(r=r||""),null!==n&&!1!==n&&(n=n||"");var i=a.$(),s=i.before,u=i.value,l=i.after,f=L(s,1),p=L(l,-1);return s=!1!==e?L(s,1)+(f||!o?e:""):s,l=!1!==t?(p||!o?t:"")+L(l,-1):l,!1!==r&&(u=L(u,-1)),!1!==n&&(u=L(u,1)),a.set(s+u+l).select(s=c(s),s+c(u))},a.pop=function(){return e.TE?(delete e.TE,a):a},a.state=o,a}_.esc=x,_.instances={},_.state={tab:"\t"},_.S=function(e,t,r){var n=this,o=r.slice(e,t);n.after=r.slice(t),n.before=r.slice(0,e),n.end=t,n.length=c(o),n.start=e,n.value=o,n.toString=function(){return o}},_.version="3.3.9",_.x=q;var E={_history:[],_historyState:-1,history:function(e){var t=this;return i(e)?i(t._history[e])?t._history[e]:null:t._history},loss:function(e){var t,r=this;return!0===e?(r._history=[],r._historyState=-1,[]):(t=r._history.splice(i(e)?e:r._historyState,1),r._historyState=a(r._historyState-1,[-1]),t)},record:function(e){var t=this,r=t.$(),n=r.end,o=r.start,s=t._history[t._historyState]||[],c=[t.self.value,o,n];return c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]||(++t._historyState,t._history[i(e)?e:t._historyState]=c),t},redo:function(){var e,t=this;return t._historyState=a(t._historyState+1,[0,c(t._history)-1]),e=t._history[t._historyState],t.set(e[0]).select(e[1],e[2])},undo:function(){var e,t=this;return t._historyState=a(t._historyState-1,[0,c(t._history)-1]),e=t._history[t._historyState],t.set(e[0]).select(e[1],e[2])}};function C(e,t){return new Promise((function(r,n){var o=d[e].apply(d,t);return o?r(o):n(o)}))}var M={source:{pairs:{"`":"`","(":")","{":"}","[":"]",'"':'"',"'":"'","<":">"},type:null}};["alert","confirm","prompt"].forEach((function(e){M.source[e]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return C(e,r)}}));var A={toggle:function(e,r,n,o){void 0===o&&(o=!1),r||""===r||(r=e);var i=this,a=i.$(),u=a.after,l=a.before,f=a.value,p=c(r),h=c(e);return n&&r===f.slice(-p)&&e===f.slice(0,h)||r===u.slice(0,p)&&e===l.slice(-h)?i.peel(e,r,n):(!1!==o&&(s(o)?o=[o,o]:t(o)||(o=["",""]),isSet(o[1])||(o[1]=o[0]),i.trim(o[0],o[1])),i.wrap(e,r,n))}};function H(t,r){var n,o,i=r.state.source.tab||r.state.tab||"\t",s=r.state.source.pairs||{},c=function(e){return Object.values(e)}(s),a=t.key,u=t.queue,l=t+"";if(u.Alt||u.Control)return!0;if(" "===l){var f=r.$(),p=f.after,h=f.before,v=f.value;return n=s[o=h.slice(-1)],!(!v&&n&&o&&n===p[0])||(r.wrap(" "," "),!1)}if("Enter"===l){var d=r.$(),m=d.after,g=d.before,b=d.value,y=g.split("\n").pop().match(/^(\s+)/),$=y&&y[1]||"";if(!b){if(m&&g&&(n=s[o=g.slice(-1)])&&n===m[0])return r.wrap("\n"+$+(o!==n?i:""),"\n"+$).record(),!1;if($)return r.insert("\n"+$,-1).record(),!1}return!0}if("Backspace"===l){var w=r.$(),k=w.after,S=w.before,x=w.value;k.split("\n")[0];var T=S.split("\n").pop(),q=T.match(/^(\s+)/),L=q&&q[1]||"";return n=s[o=S.slice(-1)],"\\"===o?!0:x?!(k&&S&&n&&n===k[0]&&!S.endsWith("\\"+o))||(r.record().peel(o,n).record(),!1):(n=s[o=S.trim().slice(-1)])&&o&&(k.startsWith(" "+n)&&S.endsWith(o+" ")||k.startsWith("\n"+L+n)&&S.endsWith(o+"\n"+L))?(r.trim("","").record(),!1):T.endsWith(i)?(r.pull(i).record(),!1):!(k&&S&&!S.endsWith("\\"+o)&&n===k[0]&&o===S.slice(-1))||(r.peel(o,n).record(),!1)}var _=r.$(),E=_.after,C=_.before,M=_.start,A=_.value;if("\\"===(o=C.slice(-1)))return!0;if(n=e(E[0],c)?E[0]:s[o],!A&&E&&C&&n&&a===n)return r.select(M+1).record(),!1;for(o in s){if(n=s[o],a===o&&n)return r.wrap(o,n).record(),!1;if(a===n){if(A)return r.record().wrap(o,n).record(),!1;break}}return!0}function W(e,t){var r=t.state.source.tab||t.state.tab||"\t";e.key,e.queue;var n=e+"";return"Control-]"===n?(t.push(r).record(),!1):"Control-["!==n||(t.pull(r).record(),!1)}function j(e,t){e.key;var r=e.queue;if(r.Control&&r.Enter){var n=t.$(),o=n.after,i=n.before,s=n.end,a=n.start,u=n.value,l=o.split("\n").shift(),f=i.split("\n").pop(),p=f.match(/^(\s+)/),h=p&&p[1]||"";if(i||o)return r.Shift?(t.select(a-c(f)).wrap(h,"\n").insert(u).record(),!1):(t.select(s+c(l)).wrap("\n"+h,"").insert(u).record(),!1)}return!0}function O(e,t){var r=e+"";return"Control-y"===r?(t.redo(),!1):"Control-z"!==r||(t.undo(),!1)}function K(t,r){t.key;var n=t+"";if(!t.queue.Control)return!0;var o,i,s,a=r.$(),u=a.after,l=a.before,f=a.end,p=a.start,h=a.value,v=r.state.source.pairs||{},d=[];if(h){for(o in v)(i=v[o])&&d.push("(?:\\"+o+"(?:\\\\.|[^\\"+o+(i!==o?"\\"+i:"")+"])*\\"+i+")");if(d.push("\\w+"),d.push("\\s+"),d.push("[\\s\\S]"),"Control-ArrowLeft"===n)return(s=l.match(T("("+d.join("|")+")$","")))?(r.insert("").select(p-c(s[0])).insert(h),r.record(),!1):(r.select(),!1);if("Control-ArrowRight"===n)return(s=u.match(T("^("+d.join("|")+")","")))?(r.insert("").select(f+c(s[0])-c(h)).insert(h),r.record(),!1):(r.select(),!1)}var m=u.split("\n").shift(),g=l.split("\n").pop(),b=g.match(/^(\s+)/);if(b&&b[1],f+=c(m),p-=c(g),h=g+h+m,"Control-ArrowUp"===n){if(!e("\n",l))return r.select(),!1;r.insert(""),r.replace(/^([^\n]*?)(\n|$)/,"$2",1),r.replace(/(^|\n)([^\n]*?)$/,"",-1);var y=r.$();return l=y.before,p=y.start,g=l.split("\n").pop(),r.select(p-=c(g)).wrap(h,"\n"),r.select(p,p+c(h)),r.record(),!1}if("Control-ArrowDown"===n){if(!e("\n",u))return r.select(),!1;r.insert(""),r.replace(/^([^\n]*?)(\n|$)/,"",1),r.replace(/(^|\n)([^\n]*?)$/,"$1",-1);var $=r.$();return u=$.after,f=$.end,m=u.split("\n").shift(),r.select(f+=c(m)).wrap("\n",h),f+=1,r.select(f,f+c(h)),r.record(),!1}return!0}var R,X,U,D=(R=function(e){return e.record()},X=100,function(){var e=arguments,t=this;U&&clearTimeout(U),U=setTimeout((function(){return R.apply(t,e)}),X)});var B=M,P="[\\w:.-]+",z=function(e){return"<("+e+")(\\s(?:'(?:\\\\.|[^'])*'|\"(?:\\\\.|[^\"])*\"|[^/>'\"])*)?>"},F=function(e){return"</("+e+")>"},I="(?:\x3c!--([\\s\\S](?!--\x3e)*)--\x3e|<!((?:'(?:\\\\.|[^'])*'|\"(?:\\\\.|[^\"])*\"|[^>'\"])*)>|"+F(P)+"|<\\?((?:'(?:\\\\.|[^'])*'|\"(?:\\\\.|[^\"])*\"|[^>'\"])*)\\?>|"+z(P)+"|"+function(e){return"<("+e+")(\\s(?:'(?:\\\\.|[^'])*'|\"(?:\\\\.|[^\"])*\"|[^/>'\"])*)?/?>"}(P)+")",J={};function N(e){if(!e)return"";e=u(e).sort().reduce((function(t,r){return t[r]=e[r],t}),{});var t,r,n="";for(t in e)!1!==(r=e[t])&&null!==r&&(n+=" "+t,!0!==r&&(n+='="'+f(h(r))+'"'));return n}function Y(e){return!1!==e&&(s(e)?e=[e,e]:t(e)||(e=["",""]),i(e[1])||(e[1]=e[0])),e}function G(e,t){var r=t.state,n=r.sourceXML.tab||r.tab||"\t",o=e.key,i=e.queue,s=e+"";if(i.Alt||i.Control)return!0;if(["-",">","/","?"," "].includes(o)){var a=t.$(),u=a.after,l=a.before,f=a.value,p=a.start;if("-"===o&&!f&&"<!-"===l.slice(-3))return t.wrap("- "," --"+(">"===u[0]?"":">")).record(),!1;if(">"===o||"/"===o){var h=T(z(P)+"$","").exec(l+">");if(!f&&h)return"/"===o?">"===u[0]?(t.trim("",!1).insert(" /",-1).select(t.$().start+1).record(),!1):(t.trim("",!1).insert(" />",-1).record(),!1):(u.startsWith("></"+h[1]+">")?t.select(p+1).record():u.startsWith("</"+h[1]+">")?t.insert(">",-1).record():t.wrap(">","</"+h[1]+(">"===u[0]?"":">")).record(),!1)}if("?"===o&&!f&&"<"===l.slice(-1))return t.wrap("?","?"+(">"===u[0]?"":">")).record(),!1;if(" "===s&&!f&&("--\x3e"===u.slice(0,3)&&"\x3c!--"===l.slice(-4)||"?>"===u.slice(0,2)&&"<?"===l.slice(0,2)&&/<\?\S*$/.test(l)))return t.wrap(" "," ").record(),!1}if("ArrowLeft"===s){var v=t.$(),d=v.before,m=v.start;if(!v.value){var g=T(I+"$","").exec(d);if(g)return t.select(m-c(g[0]),m),!1}}if("ArrowRight"===s){var b=t.$(),y=b.after,$=b.start;if(!b.value){var w=T("^"+I,"").exec(y);if(w)return t.select($,$+c(w[0])),!1}}if("Enter"===s){var k=t.$(),S=k.after,q=k.before,L=k.value,_=q.split("\n").pop().match(/^(\s+)/),E=_&&_[1]||"",C=q.match(T(z(P)+"$",""));if(!L){if(/^[ \t]*-->/.test(S)&&/<!--[ \t]*$/.test(q)||/^[ \t]*\?>/.test(S)&&/<\?\S*[ \t]*$/.test(q))return t.trim().wrap("\n"+E,"\n"+E).record(),!1;if(C)return S.startsWith("</"+C[1]+">")?t.record().trim().wrap("\n"+E+n,"\n"+E).record():t.record().wrap("\n"+E+n,"\n"+E+"</"+C[1]+">").record(),!1}}if("Backspace"===s){var M=t.$(),A=M.after,H=M.before;if(!M.value){if("\x3c!--"===H.slice(-4))return t.replace(/<!--$/,"",-1),"--\x3e"===A.slice(0,3)&&t.replace(/^-->/,"",1),t.record(),!1;if(/^\s+-->/.test(A)&&/<!--\s+$/.test(H))return t.trim(" "===H.slice(-1)?"":" "," "===A[0]?"":" ").record(),!1;if(/<\?\S*$/.test(H))return t.replace(/<\?\S*$/,"",-1),"?>"===A.slice(0,2)&&t.replace(/^\?>/,"",1),t.record(),!1;if(/^\s+\?>/.test(A)&&/<\?\S*\s+$/.test(H))return t.trim(" "===H.slice(-1)?"":" "," "===A[0]?"":" ").record(),!1;var W=T(I+"$",""),j=W.exec(H);if(j){if(" />"===H.slice(-3))return t.replace(/ \/>$/,"/>",-1).record(),!1;if("/>"===H.slice(-2))return t.replace(/\/>$/,">",-1).record(),!1;t.replace(W,"",-1);var O=j[0].slice(1).split(/\s+|>/)[0];return j[0]&&"/"!==j[0][1]&&A.startsWith("</"+O+">")&&t.replace(T("^</"+O+">",""),"",1),t.record(),!1}if(T(z(P)+"\\n(?:"+x(n)+")?$","").test(H)&&T("^\\s*"+F(P),"").test(A))return t.trim().record(),!1}}if("Delete"===s){var K=t.$(),R=K.after;if(!K.value){if("--\x3e"===R.slice(0,3))return t.replace(/^-->/,"",1).record(),!1;if("?>"===R.slice(0,2))return t.replace(/^\?>/,"",1).record(),!1;var X=T("^"+I,"");if(X.exec(R))return t.replace(X,"",1).record(),!1}}return!0}J.insert=function(e,t,r,n){void 0===t&&(t=""),void 0===r&&(r={}),void 0===n&&(n=!1);return!1!==(n=Y(n))&&this.trim(n[0],""),this.insert("<"+e+N(r)+(!1!==t?">"+t+"</"+e+">":" />")+(!1!==n?n[1]:""),-1,!0)},J.toggle=function(e,t,r,n){void 0===t&&(t=""),void 0===r&&(r={}),void 0===n&&(n=!1);var o=this,i=o.$(),s=i.after,c=i.before,a=i.value,u=z(e),l=F(e),f=T(u+"$",""),p=T("^"+l,""),h=f.test(c),v=p.test(s);return v&&h?o.replace(p,"",1).replace(f,"",-1):(f=T("^"+u,""),p=T(l+"$",""),h=f.test(a),(v=p.test(a))&&h&&o.insert(a=a.replace(p,"").replace(f,"")),!a&&t&&o.insert(t),!1!==(n=Y(n))&&o.trim(n[0],n[1]),o.wrap("<"+e+N(r)+">","</"+e+">"))},J.wrap=function(e,t,r,n){void 0===t&&(t=""),void 0===r&&(r={}),void 0===n&&(n=!1);var o=this,i=o.$();return i.after,i.before,!i.value&&t&&o.insert(t),!1!==(n=Y(n))&&o.trim(n[0],n[1]),o.wrap("<"+e+N(r)+">","</"+e+">")};var Q={source:{type:"XML"},sourceXML:{}},V=$.protocol,Z=J.toggle,ee="[\\w:.-]+",te=function(e){return"<("+e+")(\\s(?:'(?:\\\\.|[^'])*'|\"(?:\\\\.|[^\"])*\"|[^/>'\"])*)?>"},re=function(e){return"</("+e+")>"};function ne(e){return!1!==e&&(s(e)?e=[e,e]:t(e)||(e=["",""]),i(e[1])||(e[1]=e[0])),e}var oe={};oe.blocks=function(){return function(e){var t=/<(?:h([1-6])|p)(\s[^>]*)?>$/,r=/^<\/(?:h[1-6]|p)>/;e.match([t,/.*/,r],(function(n,o,i){var s=this,c=+(n[1]||0),a=n[2]||"",u=e.state.sourceHTML.elements||{},l=n[0]?u[n[0].slice(1,-1).split(/\s/)[0]]:["","",{}];!a&&l[2]&&(a=N(l[2])),s.replace(t,"",-1),s.replace(/\n+/g," "),s.replace(r,"",1);var f=l[3]||u.h1[3];!1!==(f=ne(f))&&s.trim(f[0],f[1]),c?++c>6?(s.wrap("<"+u.p[0]+(a||N(u.p[2]))+">","</"+u.p[0]+">"),o[0]&&o[0]!==u.h6[1]||s.insert(u.p[1])):(s.wrap("<"+u["h"+c][0]+(a||N(u["h"+c][2]))+">","</"+u["h"+c][0]+">"),o[0]&&o[0]!==u.p[1]||s.insert(u["h"+c][1])):(s.wrap("<"+u.h1[0]+(a||N(u.h1[2]))+">","</"+u.h1[0]+">"),o[0]&&o[0]!==u.p[1]||s.insert(u.h1[1]))}))}(this),this.record(),!1},oe.bold=function(){var e=this.state.sourceHTML.elements||{};return Z.apply(this,e.b),!1},oe.code=function(){return function(e){var t=/<(?:pre|code)(?:\s[^>]*)?>(?:\s*<code(?:\s[^>]*)?>)?$/,r=/^(?:<\/code>\s*)?<\/(?:pre|code)>/;e.match([t,/.*/,r],(function(n,o,i){var s,c=this,a=e.state.sourceHTML.elements;c.replace(t,"",-1),c.replace(r,"",1),i[0]?/^(?:<\/code>\s*)?<\/pre>/.test(i[0])?(!1!==(s=ne(s=a[""][3]))&&c.trim(s[0],s[1]),c.insert(function(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}(o[0]))):i[0].slice(0,7)==="</"+a.code[0]+">"&&(!1!==(s=ne(s=a.pre[3]))&&c.trim(s[0],s[1]),c.wrap("<"+a.pre[0]+N(a.pre[2])+"><"+a.code[0]+N(a.code[2])+">","</"+a.code[0]+"></"+a.pre[0]+">")):(!1!==(s=ne(s=a.code[3]))&&c.trim(s[0],s[1]),c.wrap("<"+a.code[0]+N(a.code[2])+">","</"+a.code[0]+">").insert(function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(o[0]||a.code[1])))}))}(this),this.record(),!1},oe.image=function(e,t){void 0===e&&(e="URL:");var n=this,o=n.$(),i=o.after,s=o.before,c=o.value,a=n.state,u=a.sourceHTML.elements||{},l=a.sourceHTML.tab||a.source.tab||a.tab||"\t",f=s.split("\n").pop().match(/^(\s+)/),p=f&&f[1]||"",h=a.source.prompt;return r(h)&&h(e,c&&/^https?:\/\/\S+$/.test(c)?c:t||V+"//").then((function(e){if(e){var t=u.img;c&&(t[2].alt=c,n.record());var r=t[3]||!1;!1!==(r=ne(r))&&n.trim(r[0],""),t[2].src=e,i&&"\n"!==i[0]||s&&"\n"!==s.slice(-1)?n.insert("<"+t[0]+N(t[2])+">"+(!1!==r?r[1]:""),-1,!0):(!1!==(r=ne(r=u.figure[3]||!1))&&n.trim(r[0],r[1]),n.insert(""),n.wrap(p+"<"+u.figure[0]+N(u.figure[2])+">\n"+p+l,p+"\n</"+u.figure[0]+">"),n.insert("<"+t[0]+N(t[2])+">\n"+p+l,-1),n.wrap("<"+u.figcaption[0]+N(u.figcaption[2])+">","</"+u.figcaption[0]+">").insert(u.figcaption[1]))}else n.focus()})),n.record(),!1},oe.italic=function(){var e=this.state.sourceHTML.elements||{};return Z.apply(this,e.i),!1},oe.link=function(e,t){void 0===e&&(e="URL:");var n=this,o=n.$().value,i=n.state,s=i.sourceHTML.elements||{},c=i.source.prompt;return r(c)&&c(e,o&&/^https?:\/\/\S+$/.test(o)?o:t||V+"//").then((function(e){if(e){var t=s.a;o&&n.record(),t[2].href=e;var r={};/[.\/?&#]/.test(e[0])||/^(data|javascript|mailto):/.test(e)||-1===e.indexOf("://")||(r.rel="nofollow",r.target="_blank");var i=ne(t[3]||!1);!1!==i||o||(i=[" "," "]),Z.call(n,t[0],t[1],p(r,t[2]),i)}else n.focus()})),n.record(),!1},oe.quote=function(){return function(e){var t=/<(blockquote|q)(?:\s[^>]*)?>\s*$/,r=/^\s*<\/(blockquote|q)>/;e.match([t,/.*/,r],(function(n,o,i){var s,c=this,a=e.state,u=a.sourceHTML.tab||a.source.tab||a.tab||"\t",l=e.state.sourceHTML.elements||{};c.replace(t,"",-1),c.replace(r,"",1),i[0]?l.blockquote[0]===i[1]?!1!==(s=ne(l[""][3]))&&c.trim(s[0],s[1]):l.q[0]===i[1]&&(!1!==(s=ne(l.blockquote[3]))&&c.trim(s[0],s[1]),c.wrap("<"+l.blockquote[0]+N(l.blockquote[2])+">\n","\n</"+l.blockquote[0]+">").insert(o[0]||l.blockquote[1]),c.replace(T("(^|\\n)"),"$1"+u)):(!1!==(s=ne(l.q[3]))&&c.trim(s[0],s[1]),c.wrap("<"+l.q[0]+N(l.q[2])+">","</"+l.q[0]+">").insert(o[0]||l.q[1]),c.replace(T("(^|\\n)"+u),"$1"))}))}(this),this.record(),!1},oe.underline=function(){var e=this.state.sourceHTML.elements||{};return Z.apply(this,e.u),!1};var ie={source:{type:"HTML"},sourceHTML:{elements:{"":["","text goes here…",{},""],a:["a","link text goes here…",{}],area:["area",!1,{}],b:["strong","text goes here…",{}],base:["base",!1,{href:""},"\n"],blockquote:["blockquote","",{},"\n"],br:["br",!1,{},["","\n"]],button:["button","text goes here…",{name:"",type:"submit"}," "],caption:["caption","caption goes here…",{},"\n"],code:["code","code goes here…",{}," "],col:["col",!1,{},"\n"],em:["em","text goes here…",{}],figcaption:["figcaption","caption goes here…",{},"\n"],figure:["figure","",{},"\n"],h1:["h1","title goes here…",{},"\n"],h2:["h2","title goes here…",{},"\n"],h3:["h3","title goes here…",{},"\n"],h4:["h4","title goes here…",{},"\n"],h5:["h5","title goes here…",{},"\n"],h6:["h6","title goes here…",{},"\n"],hr:["hr",!1,{},"\n"],i:["em","text goes here…",{}],img:["img",!1,{alt:"",src:""}," "],input:["input",!1,{name:"",type:"text"}," "],li:["li","list item goes here…",{},"\n"],link:["link",!1,{href:""},"\n"],meta:["meta",!1,{},"\n"],ol:["ol","",{},"\n"],option:["option","option goes here…",{},"\n"],p:["p","paragraph goes here…",{},"\n"],param:["param",!1,{name:""},"\n"],pre:["pre","text goes here…",{},"\n"],q:["q","quote goes here…",{}," "],script:["script","",{},"\n"],select:["select","",{name:""}," "],source:["source",!1,{src:""},"\n"],strong:["strong","text goes here…",{}],style:["style","",{},"\n"],td:["td","data goes here…",{},"\n"],textarea:["textarea","text goes here…",{name:""}," "],th:["th","title goes here…",{},"\n"],tr:["tr","",{},"\n"],track:["track",!1,{},"\n"],u:["u","text goes here…",{}],ul:["ul","",{},"\n"],wbr:["wbr",!1,{},["","\n"]]}}};function se(e){this.K.pull()}function ce(e){this.K.pull()}function ae(e){let t,r,n=this.TE,o=this.K,i=e.key,s=n.state.source.type;if(function(e){e&&e.stopPropagation()}(e),o.push(i),t=o.test())r=o.fire(t),!1===r?k(e):null===r&&console.error("Unknown command:",t);else{if("HTML"===s)return void(function(e,t){var r=t.state,n=r.sourceHTML.tab||r.source.tab||r.tab||"\t",o=r.sourceHTML.elements||{},i=e.key,s=e.queue;if(s.Control){var a=t.$(),u=a.after,l=a.before,f=a.end,p=a.start;a.value;var h=u.split("\n").shift(),v=l.split("\n").pop(),d=v.match(/^(\s+)/),m=d&&d[1]||"";if("Enter"===i){var g=h.match(T(re(ee)+"\\s*$","")),b=o[g&&g[1]||"p"]||o.p;return b[3]=["\n"+m,"\n"+m],t.select(s.Shift?p-c(v):f+c(h)),Z.apply(t,b),t.record(),!1}}if(s.Alt||s.Control)return!0;if(">"===i){var y,$=t.$(),w=$.after,k=$.before,S=$.end,x=(k.split("\n").pop()+">").match(T(te(ee)+"$","")),q=o[y=x&&x[1]||""];return!y||(q?!1!==q[1]?(">"===w[0]?t.select(S+1):t.insert(">",-1),t.insert("</"+y+">",1).insert(q[1])):">"===w[0]?t.insert(" /",-1).select(S+3):t.insert(" />",-1):(">"===w[0]?t.select(S+1):t.insert(">",-1),t.insert("</"+y+">",1)),t.record(),!1)}if("Enter"===i){var L,_,E=t.$(),C=E.after,M=E.before,A=E.value,H=C.split("\n").shift(),W=M.split("\n").pop(),j=W.match(/^(\s+)/),O=j&&j[1]||"",K=["li","option","p","td","th"],R=["script","style"];if(L=W.match(T(te(ee)+"$",""))){var X=o[L[1]];if(X&&!1===X[1])return t.insert("\n"+O,-1).record(),!1}if(C&&M){for(var U=0,D=c(K);U<D;++U)if(T("^"+re(_=K[U]),"").test(H)&&(L=W.match(T("^\\s*"+te(_),""))))return L[0]===W?(o[_]&&A&&o[_][1]===A?t.insert("").wrap("\n"+O+n,"\n"+O):Z.call(t,_),t.record(),!1):(t.insert("</"+_+">\n"+O+"<"+_+(L[2]||"")+">",-1).insert(o[_]&&o[_][1]||"").record(),!1);for(var B=0,P=c(R);B<P;++B)if(T("^"+re(_=R[B]),"").test(H)&&T(te(_)+"$","").test(W))return t.wrap("\n"+O,"\n"+O).insert(o[_]&&o[_][1]||"").record(),!1;for(var z=1;z<7;++z)if(H.startsWith("</"+o["h"+z][0]+">")&&W.match(T("^\\s*"+te(o["h"+z][0]),"")))return o["h"+z]&&A&&o["h"+z][1]===A?t.insert("").wrap("\n"+O+n,"\n"+O):t.insert("</"+o["h"+z][0]+">\n"+O+"<"+o.p[0]+">",-1).replace(T("^"+re(o["h"+z][0])),"</"+o.p[0]+">",1).insert(o.p[1]),t.record(),!1}}return!0}(o,n)&&G(o,n)&&H(o,n)&&W(o,n)&&j(o,n)&&O(o,n)&&K(o,n)||k(e));if("XML"===s)return void(G(o,n)&&H(o,n)&&W(o,n)&&j(o,n)&&O(o,n)&&K(o,n)||k(e));H(o,n)&&W(o,n)&&j(o,n)&&O(o,n)&&K(o,n)||k(e)}}function ue(e){let t=this.TE,r=this.K,n=e.key;!function(e,t){D(t)}(0,t),r.pull(n)}function le(t){let r=this.TE;!function(t,r){t.key,t.queue.Control||d.setTimeout((function(){var t=r.$(),n=t.after,o=t.before,i=t.value;if(!i)for(var s,a,u=I.split("([\\w:.-]+)").join("((?:[\\w:.-]|\ufeff)+)"),l=T(u),f=o+i+"\ufeff"+n;s=l.exec(f);)if(e("\ufeff",s[0])){r.select(a=s.index,a+c(s[0])-1);break}}),1)}(this.K,r)}function fe(){let e;for(let r in _.instances)e=_.instances[r],e.loss().pop(),delete e.self.K,delete _.instances[r],t=e.self,w("blur",t,se),w("input",t,ce),w("keydown",t,ae),w("keyup",t,ue),w("mousedown",t,le),w("touchstart",t,le);var t;let r,n,o,i,s=(a=".lot\\:field.type\\:source .textarea",(u||v).querySelectorAll(a));var a,u;s&&c(s)&&s.forEach((e=>{r=new _(e,b(e,"state")??{}),o=r.state,i=o.source.type,n=new d.K(r),"HTML"===i&&(n.commands=oe,n.keys["Control-b"]="bold",n.keys["Control-e"]="code",n.keys["Control-h"]="blocks",n.keys["Control-i"]="italic",n.keys["Control-k"]="link",n.keys["Control-o"]="image",n.keys["Control-q"]="quote",n.keys["Control-u"]="underline"),o.commands=n.commands,o.keys=n.keys,e.K=n,function(e){S("blur",e,se),S("input",e,ce),S("keydown",e,ae),S("keyup",e,ue),S("mousedown",e,le),S("touchstart",e,le),e.TE.record()}(e)}))}Object.assign(_.prototype,E,A),_.state=p({},_.state,B,Q,ie),["alert","confirm","prompt"].forEach((e=>{d._.dialog[e]&&(_.state.source[e]=d._.dialog[e])})),delete _.state.source.type,fe(),d._.on("change",fe),d.TE=_}();