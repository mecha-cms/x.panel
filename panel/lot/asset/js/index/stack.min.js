!function(){"use strict";var n=function(n){return Array.isArray(n)},t=function(n){return"function"==typeof n},e=function(n,t){return void 0===t&&(t=!0),"object"==typeof n&&(!t||function(n,t){return n&&r(t)&&n instanceof t}(n,Object))},r=function(n){return function(n){return void 0!==n}(n)&&!function(n){return null===n}(n)},u=function(n){return"string"==typeof n},i=function t(r){if(n(r))return r.map((function(n){return t(n)}));if(function(n){return/^-?(?:\d*.)?\d+$/.test(n+"")}(r))return function(n,t){return void 0===t&&(t=10),t?parseInt(n,t):parseFloat(n)}(r);if(e(r)){for(var u in r)r[u]=t(r[u]);return r}return"false"!==r&&("null"===r?null:"true"===r||r)},c=function t(r){if(n(r))return r.map((function(n){return t(r)}));if(e(r)){for(var u in r)r[u]=t(r[u]);return r}return!1===r?"false":null===r?"null":!0===r?"true":""+r},o=document,f=window,l=function(n){return n.firstElementChild||null},a=function(n,t,e){void 0===e&&(e=!0);var r=function(n,t,e){if(void 0===e&&(e=!0),!h(n,t))return null;var r=n.getAttribute(t);return e?i(r):r}(n,"data-"+t,e),u=(r+"").trim();return e&&u&&("["===u[0]&&"]"===u.slice(-1)||"{"===u[0]&&"}"===u.slice(-1))&&null!==(u=function(n){var t=null;try{t=JSON.parse(n)}catch(n){}return t}(r))?u:r},s=function(n,t){return(t||o).querySelector(n)},v=function(n,t){return(t||o).querySelectorAll(n)},d=function(n){return n.nextElementSibling||null},g=function(n){return n.parentNode||null},p=function(n){return n.previousElementSibling||null},h=function(n,t){return n.hasAttribute(t)},y=function(n,t){return n.classList.contains(t)},k=function(n,t){return n.removeAttribute(t),n},w=function(n,t){return n.classList.remove(t),n},m=function(n,t,e){return!0===e&&(e=t),n.setAttribute(t,c(e)),n},A=function(n,t){return n.classList.add(t),n},E=function(n,t,r){return n=u(n)?o.createElement(n):n,e(t)&&(r=t,t=!1),u(t)&&b(n,t),e(r)&&function(n,t){var e;for(var r in t)(e=t[r])||""===e||0===e?m(n,r,e):k(n,r)}(n,r),n},b=function(n,t,e){if(void 0===e&&(e=!0),null===t)return n;var r="innerHTML";return function(n,t){return t in n}(n,r)&&(n[r]=e?t.trim():t),n},L=function(n,t,e){return n.classList.toggle(t,e),n},D={},K=function(n,t,e,u){t.dispatchEvent(function(n,t,e){return e&&r(D[n])?D[n]:D[n]=new Event(n,t)}(n,e,u))},P=function(n){return n&&n.preventDefault()},S=function(n){return n&&n.stopPropagation()},U=function(n,t,e,r){void 0===r&&(r=!1),t.addEventListener(n,e,r)};function j(){let n=v(".lot\\:stacks");n&&n.length&&n.forEach((n=>{let t,e,r=[].slice.call((c=n.children,"number"==typeof i?c[i]||null:c||[])),u=E("input");var i,c;function o(n){let i=this,c=g(i);y(c,"has:link")||(y(i,"not:active")||(r.forEach((n=>{n!==c&&(w(n,"is:current"),w(s("a",n),"is:current"))})),y(c,"can:toggle")?(L(i,"is:current"),L(c,"is:current"),u.value=e=y(i,"is:current")?a(c,"value"):null):(A(i,"is:current"),A(c,"is:current"),u.value=e=a(c,"value")),f._.fire("change.stack",[t,e])),P(n))}u.type="hidden",u.name=t=a(n,"name"),function(n,t){n.append(t)}(n,u),r.forEach((n=>{let t=s('a[target^="stack:"]',n);U("click",t,o),U("keydown",t,q)}));let l=r.find(((n,t)=>0!==t&&y(n,"is:current")));l&&(u.value=a(l,"value")),U("keydown",n,H)}))}function q(n){let e=this,r=n.key,u=n.altKey,i=n.ctrlKey;if(!u&&!i){let u,i,c,o;if("ArrowDown"===r||"PageDown"===r){if(c=g(e))for(i=d(c);i&&y(i,"not:active");)i=d(i);(u=i&&l(i))&&(K("click",u),t(u.focus)&&u.focus()),P(n),S(n)}else if("ArrowLeft"===r){if(y(g(e),"can:toggle")&&y(e,"is:current"))u=e;else{if(c=g(e))for(o=p(c);o&&y(o,"not:active");)o=p(o);u=o&&l(o)}u&&(K("click",u),t(u.focus)&&u.focus()),P(n),S(n)}else if("ArrowRight"===r){if(y(g(e),"can:toggle")&&y(e,"is:current"))u=e;else{if(c=g(e))for(i=d(c);i&&y(i,"not:active");)i=d(i);u=i&&l(i)}u&&(K("click",u),t(u.focus)&&u.focus()),P(n),S(n)}else if("ArrowUp"===r||"PageUp"===r){if(c=g(e))for(o=p(c);o&&y(o,"not:active");)o=p(o);(u=o&&l(o))&&(K("click",u),t(u.focus)&&u.focus()),P(n),S(n)}else" "===r||"Enter"===r?(y(g(e),"can:toggle")&&(K("click",e),t(e.focus)&&e.focus()),P(n),S(n)):"Escape"===r&&(t(e.closest)&&(c=e.closest(".lot\\:stacks"))&&t(c.focus)&&c.focus(),P(n),S(n))}}function H(n){let e=this,r=n.key,u=n.altKey,i=n.ctrlKey,c=n.shiftKey;if(!u&&!i&&!c){let u;if("ArrowDown"===r||"ArrowRight"===r||"Home"===r||"PageDown"===r)(u=s('a[target^="stack:"]:not(.not\\:active)',e))&&t(u.focus)&&u.focus(),P(n),S(n);else if("ArrowUp"===r||"ArrowLeft"===r||"End"===r||"PageUp"===r){(u=[].slice.call(v('a[target^="stack:"]:not(.not\\:active)',e)).pop())&&t(u.focus)&&u.focus(),P(n),S(n)}}}j(),f._.on("change",j)}();